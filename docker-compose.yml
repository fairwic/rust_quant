version: '3.0'
services:
  prod-rust-quant:
    container_name: prod-rust-quant
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      - .:/usr/src/rust_quant
    environment:
      IS_BACK_TEST: 'false'
      IS_OPEN_SOCKET: 'false'
      IS_RUN_SYNC_DATA_JOB : 'false'
      IS_RUN_REAL_STRATEGY: 'true'
    command: sh -c "cargo build --release && ./target/release/rust_quant"
  prod-rust-quant-job:
    container_name: prod-rust-quant-job
    build:
      context: .
      dockerfile: Dockerfile
    environment:
      IS_BACK_TEST: 'false'
      IS_RUN_REAL_STRATEGY: 'false'
      IS_OPEN_SOCKET: 'true'
      IS_RUN_SYNC_DATA_JOB : 'true'
    volumes:
      - .:/usr/src/rust_quant
    command: sh -c "cargo build --release && ./target/release/rust_quant"
  mysql:
      image: mysql:8.0
      container_name: my_mysql
      restart: always
      environment:
        MYSQL_ROOT_PASSWORD: example   # root 用户密码
        MYSQL_DATABASE: test                 # 默认创建的数据库
      ports:
        - "33306:3306"
      volumes:
        - ./mysql_data:/var/lib/mysql        # 本地路径映射到 MySQL 数据目录