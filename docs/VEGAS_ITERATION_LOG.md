# Vegas ç­–ç•¥è¿­ä»£æ—¥å¿—

## è¿­ä»£è®°å½•

---

### 2026-01-09: Shadow Trading + é£æ§ä¼˜åŒ– + ATRæ­¢ç›ˆä¿®å¤

#### å®éªŒæ¦‚è§ˆ

æœ¬æ¬¡è¿­ä»£ä¸“æ³¨äºä¸‰ä¸ªæ–¹é¢ï¼š
1. **Shadow Trading å®ç°** - è®°å½•è¢«è¿‡æ»¤çš„ä¿¡å·å¹¶æ¨¡æ‹Ÿäº¤æ˜“ç»“æœ
2. **é£æ§å‚æ•°ä¼˜åŒ–** - è°ƒæ•´ `max_loss_percent` ä» 5% åˆ° 4%
3. **ATRæ­¢ç›ˆä¿®å¤** - ä¿®å¤ `atr_stop_loss_price` æœªè®¡ç®—çš„é—®é¢˜

#### 1. Shadow Tradingï¼ˆå½±å­äº¤æ˜“ï¼‰

å®ç°äº† `filtered_signal_log` è¡¨æ¥è®°å½•è¢«è¿‡æ»¤çš„ä¿¡å·ï¼Œç”¨äºåˆ†æè¿‡æ»¤å™¨æœ‰æ•ˆæ€§ã€‚

**å…³é”®å‘ç°**ï¼ˆåŸºäº592ä¸ªè¢«è¿‡æ»¤ä¿¡å·ï¼‰ï¼š

| è¿‡æ»¤åŸå›  | æ•°é‡ | å½±å­PnL | èƒœç‡ | ç»“è®º |
|---------|------|--------|------|------|
| MACD_FALLING_KNIFE_LONG | 207 | +41.10 | 74.88% | âš ï¸ å¯èƒ½è¿‡åº¦è¿‡æ»¤ |
| MACD_FALLING_KNIFE_SHORT | 195 | -36.13 | 55.38% | âœ… æœ‰æ•ˆè¿‡æ»¤ |
| CHASE_CONFIRM_FILTER_SHORT | 18 | -14.30 | 5.56% | âœ… éå¸¸æœ‰æ•ˆ |

**MACDè¿‡æ»¤å™¨æ”¾å®½å®éªŒï¼ˆ5636ï¼‰**ï¼š
- å°è¯•æ”¾å®½ MACD_FALLING_KNIFE_LONG è¿‡æ»¤æ¡ä»¶
- ç»“æœï¼šProfit 2046â†’1254 (-39%), MaxDD 49%â†’52%
- **ç»“è®º**ï¼šæ”¾å®½ååè€Œæ¶åŒ–ï¼ŒMACDè¿‡æ»¤å™¨ä¿æŒåŸæœ‰é€»è¾‘

#### 2. é£æ§å‚æ•°ä¼˜åŒ–

**4% æ­¢æŸæµ‹è¯• (5638)**ï¼š

| æŒ‡æ ‡ | åŸºçº¿ (5637, 5%SL) | 4% SL (5638) | å˜åŒ– |
|------|------------------|--------------|------|
| Sharpe | 1.56 | 1.54 | -1.3% |
| å¹´åŒ–æ”¶ç›Š | 100.84% | 98.66% | -2.2% |
| æœ€å¤§å›æ’¤ | 49.29% | **45.40%** | **-8%** |
| ç›ˆåˆ© | 2046 | 1945 | -5% |

**ç»“è®º**ï¼š4% æ­¢æŸæœ‰æ•ˆé™ä½å›æ’¤ï¼Œè½»å¾®ç‰ºç‰²æ”¶ç›Šï¼Œå·²é‡‡ç”¨ã€‚

#### 3. ATRæ­¢ç›ˆä¿®å¤

**é—®é¢˜**ï¼š`atr_stop_loss_price` åœ¨ä¿¡å·ç”Ÿæˆæ—¶å§‹ç»ˆä¸º `None`ï¼Œå¯¼è‡´ ATR æ­¢ç›ˆæ— æ³•è§¦å‘ã€‚

**ä¿®å¤**ï¼š
- åœ¨ `VegasStrategy.generate_signal()` ä¸­æ·»åŠ  ATR(14) è®¡ç®—
- å½“ç”Ÿæˆæœ‰æ•ˆä¿¡å·æ—¶è®¾ç½® `atr_stop_loss_price`ï¼š
  - åšå¤š: `å…¥åœºä»· - ATR * 1.5`
  - åšç©º: `å…¥åœºä»· + ATR * 1.5`

**ä¿®å¤åç»“æœ (5640)**ï¼š

| æŒ‡æ ‡ | ä¿®å¤å‰ (5638) | ä¿®å¤å (5640) | å˜åŒ– |
|------|--------------|--------------|------|
| **Sharpe** | 1.54 | **1.83** | **+19%** |
| **å¹´åŒ–æ”¶ç›Š** | 98.66% | **115.70%** | **+17%** |
| **ç›ˆåˆ©** | 1945 | **2838** | **+46%** |
| æœ€å¤§å›æ’¤ | 45.40% | 45.40% | æŒå¹³ |

#### æœ€ç»ˆé…ç½®

```json
{
  "max_loss_percent": 0.04,
  "atr_take_profit_ratio": 3.0
}
```

- ATRå‘¨æœŸ: 14
- æ­¢æŸä¹˜æ•°: 1.5

#### ä¸‹ä¸€æ­¥

1. ä¼˜åŒ– ATR å‚æ•°ï¼ˆå‘¨æœŸã€ä¹˜æ•°ç»„åˆï¼‰
2. æµ‹è¯•ä¸åŒæ—¶é—´æ¡†æ¶ï¼ˆ1Hã€2Hï¼‰çš„è¡¨ç°
3. è€ƒè™‘åŠ¨æ€è°ƒæ•´ ATR ä¹˜æ•°

---

### 2026-01-08: æç«¯Kçº¿è¿‡æ»¤åˆ†å¸ƒè¯•éªŒ

#### å®éªŒæ¦‚è§ˆ
- æ–°å¢ `ExtremeKFilter`ï¼ˆå¤§å®ä½“+å¤šå‡çº¿ç©¿è¶Šï¼‰è¿‡æ»¤é€†åŠ¿/å‡çªç ´ï¼Œåˆ†æ¡£æµ‹è¯•ï¼š
  - 5588 å®½æ¾ï¼šå®ä½“â‰¥0.65ã€å•æ ¹æ³¢åŠ¨â‰¥1.0%ã€è·¨â‰¥2æ¡EMAã€‚
  - 5589/5590 ä¸¥æ ¼ï¼šå®ä½“â‰¥0.70ã€å•æ ¹æ³¢åŠ¨â‰¥1.5%ã€è·¨â‰¥3æ¡EMAï¼ˆå½“å‰é»˜è®¤ï¼‰ã€‚
  - 5593 å®½æ¾ + é«˜æ³¢åŠ¨é™æŸï¼ˆæç«¯æ³¢åŠ¨é™è‡³ 4.5% æ­¢æŸï¼Œä¸Šè¿°å®½æ¾é˜ˆå€¼ï¼‰

#### ç»“æœå¯¹æ¯”
| å›æµ‹ID | æ¡£ä½ | èƒœç‡ | Profit | Sharpe | MaxDD |
|--------|------|------|--------|--------|-------|
| 5588 | å®½æ¾ | 57.51% | **1591.88** | **1.462** | 58.12% |
| 5589 | ä¸¥æ ¼ | 57.06% | 1537.32 | 1.433 | **51.93%** |
| 5590 | ä¸¥æ ¼ï¼ˆå¤ç°ï¼‰ | 57.06% | 1537.32 | 1.433 | 51.93% |
| 5593 | å®½æ¾+é™æŸ | 57.30% | **1752.61** | **1.534** | 57.74% |
| 5576 | åŸºçº¿ | 56.57% | 1556.74 | 1.435 | 52.64% |

#### ç»“è®º
- å®½æ¾æ¡£ï¼ˆ5588ï¼‰åœ¨ç›ˆåˆ©/Sharpe ä¸Šè¶…è¶ŠåŸºçº¿ï¼Œä½†å›æ’¤å‡è‡³ 58%ï¼›å¯ä½œä¸ºâ€œæ”¶ç›Šåå¥½â€å‚è€ƒã€‚
- ä¸¥æ ¼æ¡£ï¼ˆ5589/5590ï¼‰å›æ’¤ç•¥ä¼˜äºåŸºçº¿ï¼Œç›ˆåˆ©ç•¥ä½ï¼Œé€‚åˆä½œä¸ºâ€œç¨³å¥åå¥½â€å½“å‰é»˜è®¤ã€‚
- 5593ï¼ˆå®½æ¾+é«˜æ³¢åŠ¨é™æŸï¼‰åœ¨ç›ˆåˆ©/Sharpe ä¸Šæœ€ä½³ï¼Œå›æ’¤ 57.7%ï¼Œä¸ºå½“å‰é»˜è®¤å¼€å…³ç»„åˆã€‚
- æç«¯Kè¿‡æ»¤å¯¹ Sharpe æœ‰æ­£å‘ä½œç”¨ï¼Œä»éœ€é…åˆé£æ§é™ä½å®½æ¾æ¡£çš„å›æ’¤ã€‚

#### ä¸‹ä¸€æ­¥ï¼ˆç›®æ ‡ Profitâ‰ˆ2000 ä¸” win_rateâ‰¥50%ï¼‰
1) å®½æ¾æ¡£ + é«˜æ³¢åŠ¨é™æŸï¼šä¿ç•™ 5588 é˜ˆå€¼ï¼Œæç«¯æ³¢åŠ¨æ—¶ä¸´æ—¶æŠŠ `max_loss_percent` ä¸‹è°ƒè‡³ 0.045ï¼Œé™ä½å°¾éƒ¨äºæŸåå†å†²ç›ˆåˆ©ã€‚
2) åˆ†å±‚æ­¢ç›ˆï¼šå¼•å…¥ 1R/1.5R é¦–æ®µå‡ä»“ï¼Œå°¾ä»“ç»§ç»­è·Ÿéšä¿¡å·ï¼Œæé«˜ç›ˆäºæ¯”å¹¶å®ˆä½å·²å¾—æ”¶ç›Šã€‚
3) è½»é‡é•¿å‘¨æœŸç¡®è®¤ï¼šå®½æ¾æ¡£ä»…åœ¨æ—¥çº¿ä¸ 4H åŒå‘æ—¶æ”¾è¡Œï¼Œæå‡èƒœç‡å¹¶å‹å›æ’¤ã€‚
4) è¶‹åŠ¿çˆ†å‘æ”¾è¡Œï¼šç›˜æ•´åå¤§å®ä½“é¡ºåŠ¿ç©¿å¤šæ¡ EMA çš„åœºæ™¯ç›´æ¥æ”¾è¡Œï¼ˆå½“å‰ä»…è¿‡æ»¤ï¼‰ï¼Œäº‰å–æ•æ‰è¶‹åŠ¿çˆ†å‘è¡Œçš„åˆ©æ¶¦ã€‚

---

### 2026-01-07: å›æ’¤/èƒœç‡å¹³è¡¡ä¸é«˜æ³¢åŠ¨æ¢ç´¢

#### å½“å‰åŸºçº¿ï¼ˆID 5576ï¼‰
- é…ç½®ï¼š`ema_breakthrough_threshold=0.0026`ï¼Œprice_high=1.0016ï¼Œprice_low=0.998ï¼ŒRSI 14/86ï¼Œmin_total_weight=2.0ï¼›stop_lossï¼ˆä¿¡å·Kçº¿æ­¢æŸï¼‰å…³é—­ï¼›`max_loss_percent=0.05`ã€‚
- ç»©æ•ˆï¼šwin_rateâ‰ˆ56.6%ï¼Œprofitâ‰ˆ1556.74ï¼ŒSharpeâ‰ˆ1.4355ï¼Œmax_ddâ‰ˆ52.6%ã€‚
- è¯¦æƒ… INSERT INTO `test`.`back_test_log` (`id`, `strategy_type`, `inst_type`, `time`, `win_rate`, `open_positions_num`, `final_fund`, `strategy_detail`, `risk_config_detail`, `created_at`, `profit`, `one_bar_after_win_rate`, `two_bar_after_win_rate`, `three_bar_after_win_rate`, `four_bar_after_win_rate`, `five_bar_after_win_rate`, `ten_bar_after_win_rate`, `kline_start_time`, `kline_end_time`, `kline_nums`, `sharpe_ratio`, `annual_return`, `total_return`, `max_drawdown`, `volatility`) VALUES (5576, 'vegas', 'ETH-USDT-SWAP', '4H', '0.5657276995305164', 852, 1656.74, '{\"period\":\"4H\",\"min_k_line_num\":3600,\"ema_signal\":{\"ema1_length\":12,\"ema2_length\":144,\"ema3_length\":169,\"ema4_length\":576,\"ema5_length\":676,\"ema6_length\":2304,\"ema7_length\":2704,\"ema_breakthrough_threshold\":0.003,\"is_open\":true},\"volume_signal\":{\"volume_bar_num\":4,\"volume_increase_ratio\":2.5,\"volume_decrease_ratio\":2.5,\"is_open\":true},\"ema_touch_trend_signal\":{\"ema1_with_ema2_ratio\":1.01,\"ema2_with_ema3_ratio\":1.012,\"ema3_with_ema4_ratio\":1.006,\"ema4_with_ema5_ratio\":1.006,\"ema5_with_ema7_ratio\":1.022,\"price_with_ema_high_ratio\":1.002,\"price_with_ema_low_ratio\":0.995,\"is_open\":true},\"rsi_signal\":{\"rsi_length\":16,\"rsi_oversold\":14.0,\"rsi_overbought\":86.0,\"is_open\":true},\"bolling_signal\":{\"period\":12,\"multiplier\":2.0,\"is_open\":true,\"consecutive_touch_times\":4},\"signal_weights\":{\"weights\":[[\"SimpleBreakEma2through\",1.0],[\"VolumeTrend\",1.0],[\"Rsi\",1.0],[\"TrendStrength\",1.0],[\"EmaDivergence\",1.0],[\"PriceLevel\",1.0],[\"EmaTrend\",1.0],[\"Bolling\",1.0],[\"Engulfing\",1.0],[\"KlineHammer\",1.0],[\"LegDetection\",0.9],[\"MarketStructure\",0.0],[\"FairValueGap\",1.5],[\"EqualHighLow\",1.2],[\"PremiumDiscount\",1.3],[\"FakeBreakout\",0.0]],\"min_total_weight\":2.0},\"engulfing_signal\":{\"is_engulfing\":true,\"body_ratio\":0.4,\"is_open\":true},\"kline_hammer_signal\":{\"up_shadow_ratio\":0.6,\"down_shadow_ratio\":0.6},\"leg_detection_signal\":{\"size\":7,\"is_open\":true},\"market_structure_signal\":{\"swing_length\":12,\"internal_length\":2,\"swing_threshold\":0.015,\"internal_threshold\":0.015,\"enable_swing_signal\":false,\"enable_internal_signal\":true,\"is_open\":true},\"fair_value_gap_signal\":{\"threshold_multiplier\":1.0,\"auto_threshold\":true,\"is_open\":false},\"premium_discount_signal\":{\"premium_threshold\":0.05,\"discount_threshold\":0.05,\"lookback\":20,\"is_open\":false},\"fake_breakout_signal\":null,\"range_filter_signal\":{\"bb_width_threshold\":0.03,\"tp_kline_ratio\":0.6,\"is_open\":true}}', '{\"atr_take_profit_ratio\":0.0,\"is_counter_trend_pullback_take_profit\":false,\"is_move_stop_open_price_when_touch_price\":false,\"is_one_k_line_diff_stop_loss\":false,\"is_used_signal_k_line_stop_loss\":false,\"max_loss_percent\":0.05}', '2026-01-07 11:22:33', 1556.74, 0, 0, 0, 0, 0, 0, 1577232000000, 1767758400000, 13232, 1.43554, 0.895055, 15.5674, 0.526426, 0.609564);

#### å¯¹æ¯”å®éªŒ
- 5570ï¼ˆstop_loss å¼€, max_loss=0.05ï¼‰ï¼šwin_rateâ‰ˆ45.8%ï¼Œprofitâ‰ˆ1438.2ï¼ŒSharpeâ‰ˆ1.6256ï¼Œddâ‰ˆ46.2% â†’ Sharpeé«˜ä½†èƒœç‡<50%ã€‚
- 5575ï¼ˆstop_loss å¼€, max_loss=0.055ï¼‰ï¼šwin_rateâ‰ˆ45.6%ï¼ŒSharpeâ‰ˆ1.578 â†’ èƒœç‡æœªè¾¾æ ‡ã€‚
- 5577ï¼ˆstop_loss å…³, max_loss=0.055ï¼‰ï¼šwin_rateâ‰ˆ57.0%ï¼ŒSharpeâ‰ˆ1.19 â†’ Profit/Sharpe ä¸‹é™ã€‚
- 5579ï¼ˆå¼•å…¥â€œEMAæ–¹å‘æ”¾è¡Œ+å¸ƒæ—å®½>0.08 æ‹’å¼€ä»“â€ï¼‰ï¼šSharpeâ‰ˆ0.64ï¼Œæ”¶ç›Šæ˜¾è‘—ä¸‹é™ï¼Œå·²åºŸå¼ƒã€‚

#### äºæŸæ¥æºï¼ˆåŸºäº 5576ï¼‰
- â€œæœ€å¤§äºæŸæ­¢æŸâ€145 ç¬”ç´¯è®¡ -6342ï¼Œå•ç¬”äºæŸå¤šåœ¨é«˜æ³¢åŠ¨é˜¶æ®µï¼ˆ2024-04ã€2024-09ã€2025-07~12ï¼‰ã€‚
- ç›ˆåˆ©å¤´éƒ¨æ¥è‡ªâ€œåå‘ä¿¡å·å¹³ä»“/è§¦å‘å¹³ä»“â€ï¼Œè¯´æ˜è€å¿ƒæŒæœ‰çš„å‡ºåœºé€»è¾‘æœ‰æ•ˆã€‚

#### ä¸‹ä¸€æ­¥ä¼˜åŒ–æ–¹å‘ï¼ˆå¾…éªŒè¯ï¼‰
1) é«˜æ³¢åŠ¨è‡ªé€‚åº”æ­¢æŸï¼šå¸ƒæ—å¸¦å®½æˆ– ATR/ä»· è¶…é˜ˆå€¼æ—¶ä¸´æ—¶æŠŠ `max_loss_percent` ä¸‹è°ƒåˆ° 0.045ï¼Œå…¶ä½™æ—¶æ®µä¿æŒ 0.05ï¼Œå‡å°‘é«˜æ³¢åŠ¨å¤§äºã€‚
2) è¿ç»­äºæŸå†·å´ï¼šåŒæ–¹å‘/çŸ­çª—å£å†…è¿ç»­ N æ¬¡è§¦å‘â€œæœ€å¤§äºæŸæ­¢æŸâ€åï¼Œé™ä½ä»“ä½æˆ–å†·å´ä¸€æ®µæ—¶é—´ï¼Œé˜²æ­¢è¿è¸©ã€‚
3) é•¿å‘¨æœŸè¶‹åŠ¿ç¡®è®¤ï¼ˆæ¸©å’Œç‰ˆï¼‰ï¼šè¦æ±‚æ—¥çº¿ EMA æ–œç‡ä¸ 4H åŒå‘æ‰æ”¾è¡Œï¼Œé¿å…é€†åŠ¿äº¤æ˜“ï¼ˆæ¯”å…¨å±€EMAæ–¹å‘ç¡¬è¿‡æ»¤æ›´æ¸©å’Œï¼‰ã€‚
4) å‡ºåœºåˆ†å±‚ï¼šæµ®ç›ˆè¾¾ 1R/1.5R å‡åŠä»“ï¼Œå‰©ä½™ä»“ä½ç»§ç»­ç”¨åå‘ä¿¡å·å¹³ä»“ï¼Œå…¼é¡¾èƒœç‡ä¸å°¾éƒ¨æ”¶ç›Šã€‚
5) æç«¯æ³¢åŠ¨è¿‡æ»¤ï¼šåœ¨æç«¯Kï¼ˆ>5%-8%æ¶¨è·Œï¼‰åä¸€æ ¹å†…æ‹’ç»å…¥åœºï¼Œé™ä½çˆ†é‡æ­¢æŸæ¦‚ç‡ã€‚

> ä»¥ä¸Šæ–¹æ¡ˆå°šæœªå®è£…ï¼Œå½“å‰DBå·²å›æ»šè‡³åŸºçº¿ 5576 é…ç½®ï¼ˆstop_loss å…³ï¼Œmax_loss=0.05ï¼‰ã€‚

---

### 2026-01-06: ç¬¬ä¸€æ€§åŸç†æ¨¡å—é‡æ„

#### èƒŒæ™¯
åŸºäº `doc/äº¤æ˜“ä½“ç³»_ç¬¬ä¸€æ€§åŸç†.md` æ–‡æ¡£ï¼Œå¯¹ Vegas ç­–ç•¥è¿›è¡Œæ ¹æœ¬æ€§é‡æ„ï¼Œå®ç°æ–‡æ¡£ä¸­å®šä¹‰çš„æ ¸å¿ƒäº¤æ˜“è§„åˆ™ã€‚

#### æ–°å¢æ¨¡å—

| æ¨¡å— | æ–‡ä»¶è·¯å¾„ | çŠ¶æ€ | è¯´æ˜ |
|------|----------|------|------|
| å‡çªç ´æ£€æµ‹ | `indicators/src/trend/vegas/fake_breakout.rs` | âœ… ä»…æ•°æ®é‡‡é›† | æ£€æµ‹ä»·æ ¼å‡çªç ´å‰é«˜/å‰ä½åå›å½’ |
| EMAè·ç¦»è¿‡æ»¤ | `indicators/src/trend/vegas/ema_filter.rs` | â¸ï¸ æš‚åœ | è·ç¦»è¿‡è¿œæ—¶è¿‡æ»¤é€†åŠ¿ä¿¡å· |
| Rç³»ç»Ÿç§»åŠ¨æ­¢æŸ | `strategies/src/framework/backtest/r_system.rs` | â¸ï¸ å¾…é›†æˆ | åŸºäºç›ˆåˆ©Rå€æ•°çš„åŠ¨æ€æ­¢æŸ |

---

## ğŸ”¬ æ¢ç´¢è¿‡ç¨‹ï¼šå¦‚ä½•å‘ç°æœ€ä¼˜è§£

### ç¬¬ä¸€é˜¶æ®µï¼šåˆå§‹å®ç°ï¼ˆå¤±è´¥ï¼‰

**å‡è®¾**ï¼šæŒ‰ç…§ç¬¬ä¸€æ€§åŸç†æ–‡æ¡£ï¼Œå‡çªç ´ä¿¡å·åº”è¯¥ç›´æ¥è§¦å‘å¼€ä»“ï¼Œå› ä¸ºæ–‡æ¡£è¯´"å‡çªç ´ä¿¡å· â†’ ç›´æ¥å¸‚ä»·å¼€ä»“"ã€‚

**å®ç°**ï¼š
```rust
// å‡çªç ´ç›´æ¥å¼€ä»“é€»è¾‘
if fake_breakout_signal.is_bullish_fake_breakout && fake_breakout_signal.volume_confirmed {
    signal_result.should_buy = Some(true);
    signal_result.should_sell = Some(false);
}
if fake_breakout_signal.is_bearish_fake_breakout && fake_breakout_signal.volume_confirmed {
    signal_result.should_sell = Some(true);
    signal_result.should_buy = Some(false);
}
```

åŒæ—¶å®ç°äº†ï¼š
- EMAè·ç¦»è¿‡æ»¤ï¼ˆç©ºå¤´æ’åˆ—+è·ç¦»>5%+æ”¶ç›˜ä»·>ema3 â†’ ä¸åšå¤šï¼‰
- æˆäº¤é‡é€’å‡è¿‡æ»¤ï¼ˆè¿ç»­3æ ¹Kçº¿æˆäº¤é‡é€’å‡ â†’ å¿½ç•¥ä¿¡å·ï¼‰
- å‡çªç ´ä¿¡å·æƒé‡è®¾ä¸º1.8ï¼ˆæœ€é«˜æƒé‡ï¼‰

**å›æµ‹ç»“æœï¼ˆID 4996ï¼‰**ï¼š
| æŒ‡æ ‡ | åŸºçº¿ | æ–°ä»£ç  | å˜åŒ– |
|------|------|--------|------|
| ç›ˆåˆ© | +52.77 | **-40.17** | ğŸ”´ -92.94 |
| èƒœç‡ | 54.7% | 54.5% | -0.2% |
| å›æ’¤ | 73.5% | 68.0% | -5.5% |

**åˆ†æ**ï¼šç›ˆåˆ©ä»æ­£å˜è´Ÿï¼Œç­–ç•¥å®Œå…¨å¤±æ•ˆã€‚é—®é¢˜å‡ºåœ¨å“ªé‡Œï¼Ÿ

---

### ç¬¬äºŒé˜¶æ®µï¼šé—®é¢˜å®šä½ï¼ˆé€æ­¥æ’é™¤ï¼‰

**æ€è€ƒ**ï¼šæ–°ä»£ç åšäº†ä¸‰ä»¶äº‹ï¼š
1. å‡çªç ´ç›´æ¥å¼€ä»“
2. EMAè·ç¦»è¿‡æ»¤
3. æˆäº¤é‡é€’å‡è¿‡æ»¤

å“ªä¸ªæ˜¯ç½ªé­ç¥¸é¦–ï¼Ÿéœ€è¦é€ä¸€ç¦ç”¨éªŒè¯ã€‚

**å®éªŒ1ï¼šç¦ç”¨å‡çªç ´ç›´æ¥å¼€ä»“ + æˆäº¤é‡é€’å‡è¿‡æ»¤**

```rust
// æ³¨é‡Šæ‰ç›´æ¥å¼€ä»“é€»è¾‘
// if fake_breakout_signal.is_bullish_fake_breakout ... { ... }

// æ³¨é‡Šæ‰æˆäº¤é‡é€’å‡è¿‡æ»¤
// if ema_filter::check_volume_decreasing_filter(...) { ... }
```

**å›æµ‹ç»“æœï¼ˆID 4998ï¼‰**ï¼š
| æŒ‡æ ‡ | ID 4996 | ID 4998 | å˜åŒ– |
|------|---------|---------|------|
| ç›ˆåˆ© | -40.17 | **+14.03** | âœ… æ¢å¤æ­£å‘ |
| èƒœç‡ | 54.5% | 55.9% | +1.4% |
| å›æ’¤ | 68.0% | 57.8% | -10.2% |

**ç»“è®º**ï¼šç¦ç”¨è¿™ä¸¤ä¸ªé€»è¾‘åï¼Œç›ˆåˆ©æ¢å¤æ­£å‘ã€‚ä½†ä»ç„¶æ¯”åŸºçº¿ä½ï¼ˆ+14 vs +52.7ï¼‰ã€‚

---

### ç¬¬ä¸‰é˜¶æ®µï¼šç»§ç»­æ’æŸ¥

**æ€è€ƒ**ï¼šç›ˆåˆ©ä»ç„¶æ¯”åŸºçº¿ä½ï¼Œå¯èƒ½æ˜¯EMAè·ç¦»è¿‡æ»¤è¿˜åœ¨èµ·ä½œç”¨ï¼Ÿ

**å®éªŒ2ï¼šç¦ç”¨EMAè·ç¦»è¿‡æ»¤**

```rust
// æ³¨é‡Šæ‰EMAè·ç¦»è¿‡æ»¤
// if ema_distance_filter.should_filter_long ... { ... }
// if ema_distance_filter.should_filter_short ... { ... }
```

**å›æµ‹ç»“æœï¼ˆID 5000ï¼‰**ï¼š
| æŒ‡æ ‡ | ID 4998 | ID 5000 | å˜åŒ– |
|------|---------|---------|------|
| ç›ˆåˆ© | +14.03 | +14.81 | +0.78 |
| èƒœç‡ | 55.9% | 56.1% | +0.2% |
| å›æ’¤ | 57.8% | 57.4% | -0.4% |

**ç»“è®º**ï¼šEMAè·ç¦»è¿‡æ»¤å½±å“å¾ˆå°ã€‚é—®é¢˜ä¸åœ¨è¿‡æ»¤å™¨ã€‚

---

### ç¬¬å››é˜¶æ®µï¼šå…³é”®æ´å¯Ÿ

**æ€è€ƒ**ï¼š
- ç¦ç”¨äº†æ‰€æœ‰è¿‡æ»¤é€»è¾‘ï¼Œç›ˆåˆ©ä»ç„¶åªæœ‰+14.81ï¼Œè¿œä½äºåŸºçº¿+52.77
- ä½†æ–°ä»£ç çš„å‡çªç ´æ£€æµ‹æ¨¡å—ä»åœ¨è¿è¡Œï¼Œä¿¡å·ä»åœ¨åŠ å…¥conditions
- å‡çªç ´æƒé‡è®¾ä¸º1.8ï¼ˆæœ€é«˜ï¼‰ï¼Œä¼šå½±å“æ•´ä½“å¾—åˆ†è®¡ç®—

**å‡è®¾**ï¼šå‡çªç ´ä¿¡å·æƒé‡è¿‡é«˜ï¼Œæ”¹å˜äº†åŸæœ‰ä¿¡å·çš„è¯„åˆ†å¹³è¡¡ï¼Œå¯¼è‡´ä¸€äº›åŸæœ¬ä¸åº”è¯¥è§¦å‘çš„äº¤æ˜“è¢«è§¦å‘äº†ã€‚

**å®éªŒ3ï¼šå°†å‡çªç ´æƒé‡è®¾ä¸º0**

```rust
// crates/indicators/src/trend/signal_weight.rs
// å‡çªç ´æƒé‡ä»1.8æ”¹ä¸º0.0
(SignalType::FakeBreakout, 0.0),  // ä»…æ•°æ®é‡‡é›†ï¼Œä¸å‚ä¸å¾—åˆ†
```

**å›æµ‹ç»“æœï¼ˆID 5001ï¼‰**ï¼š
| æŒ‡æ ‡ | ID 5000 | ID 5001 | åŸºçº¿ | vsåŸºçº¿ |
|------|---------|---------|------|--------|
| ç›ˆåˆ© | +14.81 | **+99.68** | +52.77 | **+89%** |
| èƒœç‡ | 56.1% | 55.1% | 54.7% | +0.4% |
| å›æ’¤ | 57.4% | 65.4% | 73.5% | -8.1% |
| å¤æ™® | +0.021 | **+0.264** | +0.143 | **+85%** |

**ç»“è®º**ï¼šğŸ‰ ç›ˆåˆ©å¤§å¹…è¶…è¶ŠåŸºçº¿ï¼

---

### ç¬¬äº”é˜¶æ®µï¼šç†è§£ä¸ºä»€ä¹ˆ

**æ ¸å¿ƒé—®é¢˜**ï¼šä¸ºä»€ä¹ˆå‡çªç ´æ£€æµ‹å­˜åœ¨ä½†æƒé‡=0æ—¶ï¼Œç­–ç•¥è¡¨ç°åè€Œå¤§å¹…æå‡ï¼Ÿ

**åˆ†æ**ï¼š

1. **å‡çªç ´æ£€æµ‹æä¾›äº†é¢å¤–çš„å¸‚åœºçŠ¶æ€ä¿¡æ¯**
   - ç³»ç»ŸçŸ¥é“å½“å‰æ˜¯å¦å¤„äºå‡çªç ´ç¯å¢ƒ
   - è¿™ä¸ªä¿¡æ¯å¯èƒ½å½±å“äº†å…¶ä»–æ¨¡å—çš„è¡Œä¸ºï¼ˆå¦‚æ­¢æŸã€æ­¢ç›ˆåˆ¤æ–­ï¼‰

2. **æƒé‡=0æ„å‘³ç€ä¸ç›´æ¥å½±å“ä¿¡å·å¾—åˆ†**
   - åŸæœ‰çš„ä¿¡å·æƒé‡ç³»ç»Ÿä¿æŒå¹³è¡¡
   - ä¸ä¼šå› ä¸ºå‡çªç ´ä¿¡å·è€Œè§¦å‘é¢å¤–çš„äº¤æ˜“

3. **æ•°æ®é‡‡é›† vs ä¿¡å·è§¦å‘çš„åŒºåˆ«**
   - æ•°æ®é‡‡é›†ï¼šæ”¶é›†ä¿¡æ¯ï¼Œä¾›å…¶ä»–æ¨¡å—å‚è€ƒ
   - ä¿¡å·è§¦å‘ï¼šç›´æ¥å½±å“äº¤æ˜“å†³ç­–
   - å‰è€…æ˜¯è¾…åŠ©ï¼Œåè€…æ˜¯å†³ç­–

**ç±»æ¯”**ï¼šå°±åƒä¸€ä¸ªäº¤æ˜“å‘˜ï¼Œä»–çŸ¥é“"ç°åœ¨æ˜¯å‡çªç ´"è¿™ä¸ªä¿¡æ¯ï¼Œä½†ä»–ä¸ä¼šå› ä¸ºè¿™ä¸ªä¿¡æ¯å°±ç«‹åˆ»ä¸‹å•ï¼Œè€Œæ˜¯æŠŠå®ƒä½œä¸ºå‚è€ƒï¼Œåœ¨ç»¼åˆåˆ¤æ–­æ—¶è€ƒè™‘è¿›å»ã€‚

---

## ğŸ“Š å›æµ‹ç»“æœæ¼”å˜

| å›æµ‹ID | é…ç½®æè¿° | èƒœç‡ | ç›ˆåˆ© | å›æ’¤ | å¤æ™® | å¹´åŒ– |
|--------|----------|------|------|------|------|------|
| 4995 | **åŸºçº¿** | 54.7% | +52.77 | 73.5% | 0.143 | 10.1% |
| 4996 | å…¨éƒ¨å¯ç”¨ï¼ˆç›´æ¥å¼€ä»“+è¿‡æ»¤å™¨+æƒé‡1.8ï¼‰ | 54.5% | -40.17 | 68.0% | -0.228 | -11.0% |
| 4998 | ç¦ç”¨ç›´æ¥å¼€ä»“+æˆäº¤é‡è¿‡æ»¤ | 55.9% | +14.03 | 57.8% | +0.018 | 3.0% |
| 5000 | ç¦ç”¨æ‰€æœ‰è¿‡æ»¤å™¨ | 56.1% | +14.81 | 57.4% | +0.021 | 3.2% |
| **5001** | **å‡çªç ´æƒé‡=0** | **55.1%** | **+99.68** | **65.4%** | **0.264** | **17.1%** |

---

## ğŸ† å½“å‰æœ€ä¼˜é…ç½®ï¼ˆID 5001ï¼‰
INSERT INTO `test`.`strategy_config` (`id`, `strategy_type`, `inst_id`, `value`, `risk_config`, `time`, `created_at`, `updated_at`, `kline_start_time`, `kline_end_time`, `final_fund`, `is_deleted`) VALUES (11, 'Vegas', 'ETH-USDT-SWAP', '{\"period\": \"4H\", \"ema_signal\": {\"is_open\": true, \"ema1_length\": 12, \"ema2_length\": 144, \"ema3_length\": 169, \"ema4_length\": 576, \"ema5_length\": 676, \"ema6_length\": 2304, \"ema7_length\": 2704, \"ema_breakthrough_threshold\": 0.0032}, \"rsi_signal\": {\"is_open\": true, \"rsi_length\": 16, \"rsi_oversold\": 18.0, \"rsi_overbought\": 78.0}, \"volume_signal\": {\"is_open\": true, \"volume_bar_num\": 4, \"volume_decrease_ratio\": 2.5, \"volume_increase_ratio\": 2.5}, \"bolling_signal\": {\"period\": 12, \"is_open\": true, \"multiplier\": 2.0, \"consecutive_touch_times\": 4}, \"min_k_line_num\": 3600, \"signal_weights\": {\"weights\": [[\"SimpleBreakEma2through\", 0.7], [\"VolumeTrend\", 0.3], [\"EmaTrend\", 0.25], [\"Rsi\", 0.8], [\"Bolling\", 0.7]], \"min_total_weight\": 2.0}, \"kline_hammer_signal\": {\"up_shadow_ratio\": 0.6, \"down_shadow_ratio\": 0.6}, \"ema_touch_trend_signal\": {\"is_open\": true, \"ema1_with_ema2_ratio\": 1.01, \"ema2_with_ema3_ratio\": 1.012, \"ema3_with_ema4_ratio\": 1.006, \"ema4_with_ema5_ratio\": 1.006, \"ema5_with_ema7_ratio\": 1.022, \"price_with_ema_low_ratio\": 0.9982, \"price_with_ema_high_ratio\": 1.0022}}', '{\"max_loss_percent\": 0.06}', '4H', '2025-10-10 18:04:33', '2026-01-06 12:22:50', 1577232000000, 1760083200000, 4352010, 0);
### æ€§èƒ½æŒ‡æ ‡
| æŒ‡æ ‡ | å€¼ | vsåŸºçº¿ |
|------|-----|--------|
| èƒœç‡ | 55.1% | +0.4% |
| ç›ˆåˆ© | +99.68 | **+89%** |
| æœ€å¤§å›æ’¤ | 65.4% | -8.1% |
| å¤æ™®æ¯”ç‡ | 0.264 | **+85%** |
| å¹´åŒ–æ”¶ç›Š | 17.1% | **+69%** |

### æ•°æ®åº“é…ç½®ï¼ˆstrategy_config id=11ï¼‰

**ä¿¡å·å‚æ•°ï¼ˆvalue JSONï¼‰**ï¼š
```json
{
  "period": "4H",
  "min_k_line_num": 3600,
  "ema_signal": {
    "ema1_length": 12,
    "ema2_length": 144,
    "ema3_length": 169,
    "ema4_length": 576,
    "ema5_length": 676,
    "ema6_length": 2304,
    "ema7_length": 2704,
    "ema_breakthrough_threshold": 0.0032,
    "is_open": true
  },
  "volume_signal": {
    "volume_bar_num": 4,
    "volume_increase_ratio": 2.5,
    "volume_decrease_ratio": 2.5,
    "is_open": true
  },
  "ema_touch_trend_signal": {
    "ema1_with_ema2_ratio": 1.01,
    "ema2_with_ema3_ratio": 1.012,
    "ema3_with_ema4_ratio": 1.006,
    "ema4_with_ema5_ratio": 1.006,
    "ema5_with_ema7_ratio": 1.022,
    "price_with_ema_high_ratio": 1.0022,
    "price_with_ema_low_ratio": 0.9982,
    "is_open": true
  },
  "rsi_signal": {
    "rsi_length": 16,
    "rsi_oversold": 18.0,
    "rsi_overbought": 78.0,
    "is_open": true
  },
  "bolling_signal": {
    "period": 12,
    "multiplier": 2.0,
    "is_open": true,
    "consecutive_touch_times": 4
  },
  "kline_hammer_signal": {
    "up_shadow_ratio": 0.6,
    "down_shadow_ratio": 0.6
  },
  "signal_weights": {
    "weights": [
      ["SimpleBreakEma2through", 0.5],
      ["VolumeTrend", 0.4],
      ["EmaTrend", 0.35],
      ["Rsi", 0.6],
      ["Bolling", 0.55]
    ],
    "min_total_weight": 2.0
  }
}
```

**é£æ§å‚æ•°ï¼ˆrisk_config JSONï¼‰**ï¼š
```json
{
  "max_loss_percent": 0.06
}
```

### ä»£ç é…ç½®

**1. å‡çªç ´æƒé‡ï¼ˆ`signal_weight.rs`ï¼‰**ï¼š
```rust
// æƒé‡=0ï¼Œä»…æ•°æ®é‡‡é›†ï¼Œä¸å‚ä¸å¾—åˆ†è®¡ç®—
(SignalType::FakeBreakout, 0.0),
```

**2. ç­–ç•¥é€»è¾‘ï¼ˆ`strategy.rs`ï¼‰**ï¼š
```rust
// å‡çªç ´æ£€æµ‹å¯ç”¨ï¼Œä½†ä»¥ä¸‹é€»è¾‘è¢«ç¦ç”¨ï¼š
// - å‡çªç ´ç›´æ¥å¼€ä»“ï¼ˆæ³¨é‡Šæ‰ï¼‰
// - EMAè·ç¦»è¿‡æ»¤ï¼ˆæ³¨é‡Šæ‰ï¼‰
// - æˆäº¤é‡é€’å‡è¿‡æ»¤ï¼ˆæ³¨é‡Šæ‰ï¼‰

// å‡çªç ´ä¿¡å·ä»ç„¶åŠ å…¥conditionsï¼ˆæƒé‡=0æ‰€ä»¥ä¸å½±å“å¾—åˆ†ï¼‰
if fake_breakout_signal.has_signal() {
    conditions.push((
        SignalType::FakeBreakout,
        SignalCondition::FakeBreakout { ... },
    ));
}
```

---

## ğŸ’¡ å…³é”®ç»éªŒæ€»ç»“

### 1. æ–°æ¨¡å—é›†æˆçš„æ­£ç¡®å§¿åŠ¿

| æ­¥éª¤ | è¯´æ˜ |
|------|------|
| 1 | å…ˆå®ç°æ¨¡å—ï¼Œè®¾æƒé‡=0 |
| 2 | è¿è¡Œå›æµ‹ï¼Œå¯¹æ¯”åŸºçº¿ |
| 3 | å¦‚æœæå‡ï¼Œä¿æŒæƒé‡=0æˆ–å¾®è°ƒ |
| 4 | å¦‚æœä¸‹é™ï¼Œæ£€æŸ¥æ˜¯å¦å½±å“äº†åŸæœ‰ä¿¡å·å¹³è¡¡ |

### 2. æ•°æ®é‡‡é›† vs ä¿¡å·è§¦å‘

| ç±»å‹ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| æ•°æ®é‡‡é›† | æƒé‡=0ï¼Œä»…è®°å½•ä¿¡æ¯ | è¾…åŠ©å…¶ä»–æ¨¡å—åˆ¤æ–­ |
| ä¿¡å·è§¦å‘ | æƒé‡>0ï¼Œå½±å“å¾—åˆ† | ç›´æ¥å‚ä¸äº¤æ˜“å†³ç­– |

**ç»“è®º**ï¼šæ–°æ¨¡å—åº”è¯¥å…ˆä½œä¸ºæ•°æ®é‡‡é›†ï¼ŒéªŒè¯æœ‰æ•ˆåå†è€ƒè™‘æ˜¯å¦å‚ä¸ä¿¡å·è§¦å‘ã€‚

### 3. è¿‡æ»¤å™¨çš„åŒåˆƒå‰‘æ•ˆåº”

è¿‡æ»¤å™¨çš„æœ¬æ„æ˜¯è¿‡æ»¤å‡ä¿¡å·ï¼Œä½†å¦‚æœé˜ˆå€¼ä¸åˆé€‚ï¼Œä¼šè¿‡æ»¤æ‰æœ‰æ•ˆä¿¡å·ã€‚

| è¿‡æ»¤å™¨ | é¢„æœŸæ•ˆæœ | å®é™…æ•ˆæœ |
|--------|----------|----------|
| EMAè·ç¦»è¿‡æ»¤ | è¿‡æ»¤é€†åŠ¿å‡ä¿¡å· | è¿‡æ»¤äº†éƒ¨åˆ†æœ‰æ•ˆä¿¡å· |
| æˆäº¤é‡é€’å‡è¿‡æ»¤ | è¿‡æ»¤æ— åŠ›ä¿¡å· | è¿‡æ»¤äº†éƒ¨åˆ†æœ‰æ•ˆä¿¡å· |

**ç»“è®º**ï¼šè¿‡æ»¤å™¨éœ€è¦ç²¾ç»†è°ƒå‚ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨é»˜è®¤é˜ˆå€¼ã€‚

### 4. æƒé‡ç³»ç»Ÿçš„å¹³è¡¡æ€§

åŸæœ‰çš„æƒé‡ç³»ç»Ÿç»è¿‡å¤šæ¬¡è°ƒä¼˜ï¼Œå„ä¿¡å·ä¹‹é—´å·²ç»è¾¾åˆ°å¹³è¡¡ã€‚æ–°å¢ä¿¡å·å¦‚æœæƒé‡è¿‡é«˜ï¼Œä¼šæ‰“ç ´è¿™ä¸ªå¹³è¡¡ã€‚

**é”™è¯¯åšæ³•**ï¼š
```rust
(SignalType::FakeBreakout, 1.8),  // æœ€é«˜æƒé‡ï¼Œæ‰“ç ´å¹³è¡¡
```

**æ­£ç¡®åšæ³•**ï¼š
```rust
(SignalType::FakeBreakout, 0.0),  // å…ˆè®¾ä¸º0ï¼Œè§‚å¯Ÿæ•ˆæœ
```

---

## ä¸‹ä¸€æ­¥è®¡åˆ’

1. **Rç³»ç»Ÿç§»åŠ¨æ­¢æŸé›†æˆ**ï¼šå°† `r_system.rs` é›†æˆåˆ°é£æ§æµç¨‹
2. **åˆ†æ‰¹æ­¢ç›ˆå®ç°**ï¼š40%/30%/30%åˆ†é˜¶æ®µæ­¢ç›ˆ
3. **è¿‡æ»¤å™¨é˜ˆå€¼è°ƒä¼˜**ï¼šè°ƒæ•´EMAè·ç¦»å’Œæˆäº¤é‡è¿‡æ»¤çš„é˜ˆå€¼
4. **æ—¶é—´æ­¢æŸ**ï¼š12/24/48 Kçº¿æ— ç›ˆåˆ©è‡ªåŠ¨å¹³ä»“

---

## å†å²åŸºçº¿

| æ—¥æœŸ | å›æµ‹ID | é…ç½® | èƒœç‡ | ç›ˆåˆ© | å¤‡æ³¨ |
|------|--------|------|------|------|------|
| 2026-01-06 | 4995 | ç»„åˆE | 54.7% | +52.77 | æ—§åŸºçº¿ |
| 2026-01-06 | 5001 | ç¬¬ä¸€æ€§åŸç†v1 | 55.1% | +99.68 | **æ–°åŸºçº¿** |
